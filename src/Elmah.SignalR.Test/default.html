<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/jquery-1.6.4.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery.signalR.min.js" type="text/javascript"></script>
    <script src="signalr/hubs" type="text/javascript"></script>
</head>
<body>
    <div>
        <script type="text/javascript">
            $(function () {

                var elmahr = $.connection.elmahr;

                $.connection.hub.start(function () {
                    elmahr.connect();
                });
                
                elmahr.notifyError = function (envelope) {
                    var d = new Date(parseFloat(envelope.error.time.slice(6, 19))).toLocaleString();
                    var e = envelope.error;
                    var id = envelope.id;
                    var messagesId = 'messages' + id;
                    var containerId = 'container' + id;

                    if (!$("#messages" + id).is('*')) {
                        $('#applications').append('<ul id="' + containerId + '"></ul>');
                        $('#' + containerId).html('<div><h3>' + envelope.applicationName + ' (' + id + ')</h3><ol id="' + messagesId + '"></ol></div>');
                    }

                    $('#' + messagesId).prepend('<li>[' + d + '] Error on ' + e.host + ' of type <b>' + e.type + '</b>: ' + e.message + '</li>');
                };

            });
        </script>
            
        <h2>SignalR-ed Unhandled exceptions</h2>
        
        <ul id="applications">
        </ul>
        
    </div>
</body>
</html>

